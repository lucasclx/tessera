<div class="dashboard-container">
  <nav class="sidebar">
    <div class="sidebar-header">
      <h2>Portal do Aluno</h2>
      <div class="user-profile">
        <div class="profile-image">{{ username?.charAt(0) | uppercase }}</div>
        <div class="profile-info">
          <h3>{{ username || 'Aluno' }}</h3>
          <span class="status">Aluno</span>
        </div>
      </div>
    </div>
    <ul class="nav-menu">
      <li class="nav-item active">
        <a routerLink="/dashboard/aluno" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}"><mat-icon>dashboard</mat-icon> Dashboard</a>
      </li>
      <li class="nav-item">
        <a routerLink="#"><mat-icon>school</mat-icon> Disciplinas</a>
      </li>
      <li class="nav-item">
        <a routerLink="#"><mat-icon>grading</mat-icon> Notas</a>
      </li>
      <li class="nav-item">
        <a routerLink="#"><mat-icon>calendar_today</mat-icon> Agenda</a>
      </li>
      <li class="nav-item">
        <a routerLink="#"><mat-icon>menu_book</mat-icon> Biblioteca</a>
      </li>
      <li class="nav-item">
        <a routerLink="#"><mat-icon>mail</mat-icon> Mensagens</a>
      </li>
    </ul>
    <div class="sidebar-footer">
      <button mat-flat-button color="warn" (click)="logout()" class="btn-logout">
        <mat-icon>logout</mat-icon> Sair
      </button>
    </div>
  </nav>

  <main class="main-content">
    <header class="main-header">
        <div class="header-title-container">
            <h1>Olá, {{ username || 'Aluno' }}!</h1>
            <p>Bem-vindo ao seu portal acadêmico.</p>
        </div>
      <div class="header-actions">
        <div class="search-bar">
          <mat-icon>search</mat-icon>
          <input type="text" placeholder="Pesquisar..." />
        </div>
        <button mat-icon-button class="btn-notification">
          <mat-icon [matBadge]="dashboardData.mensagensNaoLidas > 0 ? dashboardData.mensagensNaoLidas : null" matBadgeColor="warn">notifications</mat-icon>
        </button>
        <button mat-icon-button class="btn-settings">
          <mat-icon>settings</mat-icon>
        </button>
      </div>
    </header>

    <div class="dashboard-content">
      <section class="monografias-section card">
        <div class="card-header">
          <h2 class="card-title">Minhas Monografias</h2>
          <button mat-raised-button color="primary" (click)="iniciarNovaMonografia()">
            <mat-icon>add_circle_outline</mat-icon> Iniciar Nova Monografia
          </button>
        </div>
        <div class="card-content">
          <div *ngIf="loadingMonografias" class="loading-state">
            <mat-spinner diameter="40"></mat-spinner>
            <p>Carregando suas monografias...</p>
          </div>

          <div *ngIf="!loadingMonografias && erroMonografias" class="error-state">
            <mat-icon color="warn">error_outline</mat-icon>
            <p>{{ erroMonografias }}</p>
            <button mat-stroked-button color="primary" (click)="carregarMinhasMonografias()">Tentar Novamente</button>
          </div>

          <div *ngIf="!loadingMonografias && !erroMonografias && minhasMonografias.length === 0" class="empty-state">
            <mat-icon class="empty-icon">description</mat-icon>
            <p>Você ainda não iniciou nenhuma monografia.</p>
            <p>Clique em "Iniciar Nova Monografia" para começar.</p>
          </div>

          <mat-list *ngIf="!loadingMonografias && !erroMonografias && minhasMonografias.length > 0" role="list">
            <h3 matSubheader *ngIf="minhasMonografias.length > 0">Suas monografias:</h3>
            <mat-list-item *ngFor="let mono of minhasMonografias" role="listitem" class="monografia-item">
              <mat-icon matListItemIcon>article</mat-icon>
              <div matListItemTitle class="monografia-title">{{ mono.titulo }}</div>
              <div matListItemLine class="monografia-details">
                <span>Orientador: {{ mono.orientadorPrincipal?.nome || 'Não definido' }}</span>
                <span class="monografia-status">Status: Em Andamento (Exemplo)</span>
              </div>
              <div matListItemMeta class="monografia-actions">
                <button mat-flat-button color="accent" (click)="navegarParaEditor(mono.id)">
                  <mat-icon>edit</mat-icon> Abrir Editor
                </button>
              </div>
            </mat-list-item>
            <mat-divider *ngIf="minhasMonografias.length > 0"></mat-divider>
          </mat-list>
        </div>
      </section>
      <div class="dashboard-grid">
        <div class="card card-summary">
          <div class="card-header">
            <h3>Resumo Acadêmico</h3>
            <span class="card-icon">
              <mat-icon>assessment</mat-icon>
            </span>
          </div>
          <div class="card-content">
            <div class="summary-item">
              <span class="item-label">Disciplinas Cursando</span>
              <span class="item-value">{{ dashboardData.disciplinasCursando }}</span>
            </div>
            <div class="summary-item">
              <span class="item-label">Média Geral</span>
              <span class="item-value">{{ dashboardData.mediaGeral }}</span>
            </div>
            <div class="summary-item">
              <span class="item-label">Atividades Pendentes</span>
              <span class="item-value">{{ dashboardData.atividadesPendentes }}</span>
            </div>
          </div>
        </div>

        <div class="card card-schedule">
          <div class="card-header">
            <h3>Próximas Aulas</h3>
            <button mat-button color="primary">Ver Agenda</button>
          </div>
          <div class="card-content">
            <div *ngFor="let aula of dashboardData.proximasAulas" class="schedule-item">
              <div class="schedule-time">{{ aula.hora }}</div>
              <div class="schedule-info">
                <h4>{{ aula.materia }}</h4>
                <p>{{ aula.sala }}</p>
              </div>
            </div>
          </div>
        </div>

        <div class="card card-assignments">
          <div class="card-header">
            <h3>Atividades Pendentes</h3>
            <button mat-button color="primary">Ver Todas</button>
          </div>
          <div class="card-content">
            <div *ngFor="let atividade of dashboardData.atividades" class="assignment-item">
              <div class="assignment-info">
                <h4>{{ atividade.titulo }}</h4>
                <p>{{ atividade.materia }}</p>
              </div>
              <span class="assignment-status" [class.urgent]="atividade.urgente">{{ atividade.status }}</span>
            </div>
          </div>
        </div>

        <div class="card card-grades">
            <div class="card-header">
                <h3>Notas Recentes</h3>
                <button mat-button color="primary">Ver Boletim</button>
            </div>
            <div class="card-content">
                <div *ngFor="let nota of dashboardData.notasRecentes" class="grade-item">
                    <div class="grade-info">
                        <h4>{{nota.tipo}}</h4>
                        <p>{{nota.materia}}</p>
                    </div>
                    <span class="grade-value" [ngClass]="nota.classeNota">{{nota.nota}}</span>
                </div>
            </div>
        </div>
      </div>
      </div>
  </main>
</div>